webpackJsonp([4],{0:function(e,t,n){n("briU"),e.exports=n("NHnr")},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("7+uW"),a=n("glag"),s=n.n(a),r=(n("xlLU"),n("briU"),{render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("ul",{staticClass:"nav"},[n("li",[n("router-link",{attrs:{to:"/HelloWorld",tag:"button","active-class":"current"}},[e._v("\n        HelloWorld\n      ")])],1),e._v(" "),n("li",[n("router-link",{attrs:{to:{path:"/News",query:{title:"中国城市GDP排名出炉",content:"深圳位列第3"}}}},[e._v("\n        新闻\n      ")])],1),e._v(" "),n("li",[n("router-link",{attrs:{to:{name:"Message",params:{content:"饿了么新增一条订单信息"}}}},[e._v("\n        消息\n      ")])],1),e._v(" "),n("li",[n("router-link",{attrs:{to:"/Order/123/456"}},[e._v("\n        订单\n      ")])],1)]),e._v(" "),n("div",[n("router-view")],1)])},staticRenderFns:[]});var i=n("VU/8")({name:"App"},r,!1,function(e){n("XoL6")},null,null).exports,l=n("/ocq"),u=n("R4Sj");o.default.use(u.a);var c=new u.a.Store({state:{token:""},mutations:{set_token:function(e,t){e.token=t,sessionStorage.token=t},del_token:function(e){e.token="",sessionStorage.removeItem("token")}}});var d={name:"Login",data:function(){return{}},props:{myTitle:{type:String,default:"标题党"}},methods:{toLogin:function(){var e=this;this.$axios({method:"post",url:"/api/manager/AdmLogin/AdminLogin",data:{username:"admin",password:"123456"}}).then(function(t){var n=t.data.Result;e.$store.commit("set_token",n.Token),e.$store.state.token?e.$router.push("/News"):e.$router.replace("/HelloWorld")}).catch(function(e){console.log(e,"账号或密码错误")})},getData:function(){this.$http.get("/api/manager/SysInsideTag/SysInsideTagList",{tagName:"",tagType:"",status:"",pageIndex:1,pageSize:20}).then(function(e){console.log(e)}).catch(function(e){console.log(e)})}}},m={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-button",{attrs:{type:"success",size:"small"},on:{click:e.toLogin}},[e._v("登录=>token")]),e._v(" "),n("br"),e._v(" "),n("el-button",{attrs:{size:"small"},on:{click:e.getData}},[e._v("测试axios拦截器")]),e._v(" "),n("p",[e._v(e._s(e.myTitle))]),e._v(" "),n("br"),n("br")],1)},staticRenderFns:[]},p={name:"HelloWorld",data:function(){return{msg:"Welcome to HelloWorld"}},methods:{doLogin:function(){this.$axios({method:"post",url:"http://192.168.1.251:8081/user/login",data:{UserName:"admin",Password:this.$MD5("123456")}}).then(function(e){console.log(e,"登录响应")})},getList:function(){this.$axios({method:"post",url:"http://192.168.1.251:8081/api/product/queryproduct",data:{ProductName:"",PageIndex:1,PageSize:10}}).then(function(e){console.log(e.data.Data.ResultList)})}},mounted:function(){},components:{"v-login":n("VU/8")(d,m,!1,null,null,null).exports}},g={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"hello"},[e._v("\n  "+e._s(e.msg)+"\n  "),n("br"),e._v(" "),n("button",{on:{click:e.doLogin}},[e._v("\n    登录\n  ")]),e._v("\n      \n  "),n("button",{on:{click:e.getList}},[e._v("\n    session问题\n  ")]),e._v(" "),n("br"),n("br"),e._v(" "),n("div",[n("v-login",{attrs:{myTitle:"title"}})],1),e._v(" "),n("pre",[e._v("    在vue中如何获取token，并将token写进header\n      1.在login.vue中通过发送http请求获取token\n\n      2.在store.js中对token状态进行监管\n\n      3.在router/index.js中设置路由拦截\n\n      4.在main.js中定义全局默认配置：\n        Axios.defaults.headers.common['Token'] \n        = \n        store.state.token;\n        Token：名字跟后台设置保持一致\n      \n      5.在main.js里添加拦截器\n  ")])])},staticRenderFns:[]};var f=n("VU/8")(p,g,!1,function(e){n("p4UH")},"data-v-7bcdffa0",null).exports;sessionStorage.getItem("token")&&c.commit("set_token",sessionStorage.getItem("token")),o.default.use(l.a);var h=new l.a({mode:"history",routes:[{path:"/",name:"HelloWorld",component:f},{path:"/HelloWorld",name:"HelloWorld",component:f},{path:"/News",name:"News",component:function(){return n.e(1).then(n.bind(null,"zSHs"))},meta:{requireAuth:!0}},{path:"/Order/:OrderId/:OrderNumber",name:"Order",component:function(){return n.e(2).then(n.bind(null,"0mnt"))},meta:{requireAuth:!0}},{path:"/Message",name:"Message",component:function(){return n.e(0).then(n.bind(null,"KPGV"))},meta:{requireAuth:!0}}]});h.beforeEach(function(e,t,n){e.matched.some(function(e){return e.meta.requireAuth})?c.state.token?n():(Object(a.Message)("访问该路由需登录以获得token"),n({path:"/HelloWorld"})):n()});var v=h,k=n("aozt"),_=n.n(k),b=n("//Fk"),y=n.n(b);_.a.interceptors.request.use(function(e){return c.state.token&&(e.headers.auth=c.state.token+"jhe"),e},function(e){return y.a.reject(e)}),_.a.interceptors.response.use(function(e){return e},function(e){if(e.response)switch(e.response.status){case 400:e.message="请求错误(400)";break;case 401:c.commit("del_token"),e.message="未授权，请重新登录(401)",v.replace({path:"/HelloWorld"});break;case 403:e.message="拒绝访问(403)";break;case 404:e.message="请求出错(404)";break;case 408:e.message="请求超时(408)";break;case 500:e.message="服务器错误(500)";break;case 501:e.message="服务未实现(501)";break;case 502:e.message="网络错误(502)";break;case 503:e.message="服务不可用(503)";break;case 504:e.message="网络超时(504)";break;case 505:e.message="HTTP版本不受支持(505)";break;default:e.message="连接出错("+e.response.status+")!"}return y.a.reject(e.message)});var w=_.a,x=n("Wn42"),H=n.n(x),$=n("KPSb"),L=n.n($);o.default.use(s.a),o.default.prototype.$http=w,_.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8",o.default.prototype.$axios=_.a,o.default.prototype.$Qs=H.a,o.default.prototype.$MD5=L.a,_.a.defaults.withCredentials=!0,o.default.config.productionTip=!1,new o.default({el:"#app",store:c,router:v,components:{App:i},template:"<App/>"})},XoL6:function(e,t){},p4UH:function(e,t){},xlLU:function(e,t){}},[0]);
//# sourceMappingURL=app.7015ab0f206dfa00c280.js.map